<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>El laberinto del Druida</title>
	<style type="text/css"> body { margin: 0; } </style>
	<script type="text/javascript" src="JS/libs/jquery-3.6.0.min.js"></script>
</head>
<body>
<script type="module" src="JS/gameScript.js"></script>
<!-- ---------------- Custom Shader Code ------------------------ -->
<script id="vertexShader" type="x-shader/x-vertex">
uniform sampler2D bumpTexture;
uniform float bumpScale;

varying float vAmount;
varying vec2 vUV;

void main() 
{ 
	vUV = uv;
	vec4 bumpData = texture2D( bumpTexture, uv );
	
	vAmount = bumpData.r; // assuming map is grayscale it doesn't matter if you use r, g, or b.
	
	// move the position along the normal
    vec3 newPosition = position + normal * bumpScale * vAmount;
	
	gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );
}
</script>

<!-- fragment shader a.k.a. pixel shader -->
<script id="fragmentShader" type="x-shader/x-fragment"> 
uniform sampler2D blendMap;
uniform sampler2D soilTexture;
uniform sampler2D stonesTexture;
uniform sampler2D pisoTexture;
uniform sampler2D mossTexture;

varying vec2 vUV;

varying float vAmount;

void main() 
{	
	vec4 tbBlend=texture2D( blendMap, vUV );

	float tbBaseWeight=1.0 - max(tbBlend.r, max(tbBlend.g, tbBlend.b));

	vec4 base =  tbBaseWeight * texture2D( stonesTexture, vUV * 10 );
	vec4 soil = tbBlend.r * texture2D( soilTexture, vUV * 10 );
	vec4 piso = tbBlend.g * texture2D( pisoTexture, vUV * 10 );
	vec4 moss = tbBlend.b * texture2D( mossTexture, vUV * 10 );
	gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0) + base + soil + piso + moss/ (tbBaseWeight+tbBlend.r+tbBlend.g+tbBlend.b);



	/*
	vec4 water = (smoothstep(0.01, 0.25, vAmount) - smoothstep(0.24, 0.26, vAmount)) * texture2D( oceanTexture, vUV * 10.0 );
	vec4 sandy = (smoothstep(0.24, 0.27, vAmount) - smoothstep(0.28, 0.31, vAmount)) * texture2D( sandyTexture, vUV * 10.0 );
	vec4 grass = (smoothstep(0.28, 0.32, vAmount) - smoothstep(0.35, 0.40, vAmount)) * texture2D( grassTexture, vUV * 20.0 );
	vec4 rocky = (smoothstep(0.30, 0.50, vAmount) - smoothstep(0.40, 0.70, vAmount)) * texture2D( rockyTexture, vUV * 20.0 );
	vec4 snowy = (smoothstep(0.50, 0.65, vAmount))                                   * texture2D( snowyTexture, vUV * 10.0 );
	gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0) + water + sandy + grass + rocky + snowy; //, 1.0);*/
}  
</script>
</body>
</html>